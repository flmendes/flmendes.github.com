---
layout: post
title: Diferença entre datas no PHP
published: true
date: 2010-09-24
categories:
- php
posterous_url: http://flmendes.posterous.com/diferenca-entre-datas-no-php
posterous_slug: diferenca-entre-datas-no-php
---
<p>Uma coisa bem chata em PHP é efetuar operações com datas. Se o seu servidor tem suporte ao PHP 5.3, então a coisa fica bem mais simples, graças ao objeto DateTime.</p>

<p>Vamos a um exemplo, quero recuperar o total de dias entre 24/10/2010 até 25/12/2010.</p>

<div class="CodeRay">
  <div class="code"><pre><span class="local-variable">$atual</span> = <span class="keyword">new</span> <span class="constant">DateTime</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">2010-10-24</span><span class="delimiter">&quot;</span></span>);
<span class="local-variable">$natal</span> = <span class="keyword">new</span> <span class="constant">DateTime</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">2010-12-25</span><span class="delimiter">&quot;</span></span>); <span class="comment">//quero verificar quantos dias falta para o natal</span>
<span class="predefined">echo</span> <span class="local-variable">$data2</span>-&gt;diff(<span class="local-variable">$data1</span>)-&gt;format(<span class="string"><span class="delimiter">'</span><span class="content">%a dias</span><span class="delimiter">'</span></span>);<span class="comment">//imprime 92 dias</span></pre></div>
</div>


<p>O método diff da classe DateTime retorna um outro objeto chamada DateInterval, o método format com o parametro %a, formata a quantidade total de dias.</p>

<p>Graças a Deus agora temos o DateTime.
Bom se o seu servidor não tem suporte ao PHP 5.3, segue uma versão alternativa de como recuperar os dias.</p>

<div class="CodeRay">
  <div class="code"><pre><span class="local-variable">$atual</span> = <span class="predefined">strtotime</span>(<span class="string"><span class="delimiter">'</span><span class="content">2010-09-24</span><span class="delimiter">'</span></span>);
<span class="local-variable">$natal</span> = <span class="predefined">strtotime</span>(<span class="string"><span class="delimiter">'</span><span class="content">2010-12-25</span><span class="delimiter">'</span></span>);
<span class="local-variable">$diff</span> = <span class="local-variable">$natal</span>  - <span class="local-variable">$atual</span>;
<span class="local-variable">$dias</span> = <span class="predefined">ceil</span>(<span class="local-variable">$diff</span>/(<span class="integer">60</span>*<span class="integer">60</span>*<span class="integer">24</span>));</pre></div>
</div>


<p>Com o strtotime ele recebe um string e retorna um timestamp, de posse deste timestamp, podemos efetuar qualquer operação matemática, neste exemplo vamos trabalha com a diferença.</p>

<p>Como quero recuperar a quantidade de dias onde 1 dia tem 24 horas, 1 hora tem 60 minutos e 1 minuto tem 60 segundos, vou dividir o valor da variável $diff por resultado da multiplicação 60<em>60</em>24, o número arredondado é a sua quantidade de dias.</p>

<p><strong>Qualquer duvida coloque no comentário.</strong></p>

<p>Referências</p>

<ul>
<li><a href="http://br2.php.net/manual/en/function.ceil.php">ceil</a></li>
<li><a href="http://br2.php.net/manual/en/function.strtotime.php">strtotime</a></li>
<li><a href="http://br2.php.net/manual/en/datetime.diff.php">DateTime diff</a></li>
<li><a href="http://br2.php.net/manual/en/class.dateinterval.php">DateInterval</a></li>
</ul>
