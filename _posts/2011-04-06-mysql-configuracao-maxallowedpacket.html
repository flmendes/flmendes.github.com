---
layout: post
title: MySQL configuração "max_allowed_packet"
published: true
date: 2011-04-06
categories:
- mysql
posterous_url: http://flmendes.posterous.com/mysql-configuracao-maxallowedpacket
posterous_slug: mysql-configuracao-maxallowedpacket
---
<p>Há uns dias atrás estava fazendo um restore de um dump de mais ou menos 500MB. Até aí tudo bem, mas o MySQL começou a retornar a seguinte mensagem de erro.</p>

<div class="CodeRay">
  <div class="code"><pre>ERROR 1153 (08S01) at line 651032: Got a packet bigger than 'max_allowed_packet' bytes</pre></div>
</div>


<p>O servidor de banco estava em uma máquina de desenvolvimento com Mac OS X 10.6. Até aí nada de mais, mas a instalação do MySQL para o Mac não cria arquivo de configuração.
Para resolver o meu problema eu fiz o seguinte, abri um terminal e digitei.</p>

<div class="CodeRay">
  <div class="code"><pre>mysqladmin -u root</pre></div>
</div>


<p>O sistema retornou a seguinte saída:</p>

<div class="CodeRay">
  <div class="code"><pre>Default options are read from the following files in the given order: 
/etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnf</pre></div>
</div>


<p>Note que no meu caso não foi necessário especificar a senha, pois a minha máquina e de desenvolvimento. Se o usuário root do seu servidor possuir um senha, adicione o parâmetro -p seguido da senha.
Exemplo:</p>

<p>   #!terminal
   mysqladmin -u root -p123</p>

<p>Detalhe importante não existe espaço entre o parâmetro e a senha informada(123).
Beleza, na resposta do servidor ele informou que o arquivo de configuração do MySQL, pode ser salvo nos diretórios /etc/my.cnf, /etc/mysql/my.cnf, /usr/local/mysql/etc/my.cnf ou ~/.my.cnf.
Pra resolver o meu problema fiz o seguinte, criei um arquivo my.cnf no diretório /etc, com o seguinte conteúdo.</p>

<div class="CodeRay">
  <div class="code"><pre>[mysqld]
max_allowed_packet=32M</pre></div>
</div>


<p>Pronto, agora basta reinicie o serviço do MySQL e o script de dump de 500MB roda redondo.
Então fica a dica, quando instalar o MySQL em uma máquina Linux ou Mac OS X, verifique se o arquivo de configuração existe nos diretórios listados acima, caso não encontre, basta copiar o template fornecido pelo MySQL.
Abra um terminal, e siga os seguintes passos.</p>

<div class="CodeRay">
  <div class="code"><pre>cd /usr/local/mysql/support-files/
sudo cp my-huge.cnf /etc/my.cnf</pre></div>
</div>


<p>Pronto, reinicie o serviço do MySQL.</p>
